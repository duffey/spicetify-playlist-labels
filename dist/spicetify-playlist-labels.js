!async function(){for(;!Spicetify.React||!Spicetify.ReactDOM;)await new Promise(t=>setTimeout(t,10));var n,o,i,c,a,p,l,u,y,r,s,m,f,t,e,d,v,b,h,w,g,k,x,S,P,L,E,O,I,R,j,C,T;n=Object.create,o=Object.defineProperty,i=Object.defineProperties,c=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertyNames,l=Object.getOwnPropertySymbols,u=Object.getPrototypeOf,y=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,s=(t,e,i)=>e in t?o(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,m=(t,e)=>{for(var i in e=e||{})y.call(e,i)&&s(t,i,e[i]);if(l)for(var i of l(e))r.call(e,i)&&s(t,i,e[i]);return t},f=(t,e)=>i(t,a(e)),d=(t=(t,e)=>function(){return e||(0,t[p(t)[0]])((e={exports:{}}).exports,e),e.exports})({"external-global-plugin:react-dom"(t,e){e.exports=Spicetify.ReactDOM}}),v=(e=(t,e,i)=>{i=null!=t?n(u(t)):{};var a=!e&&t&&t.__esModule?i:o(i,"default",{value:t,enumerable:!0}),l=t,r=void 0,s=void 0;if(l&&"object"==typeof l||"function"==typeof l)for(let t of p(l))y.call(a,t)||t===r||o(a,t,{get:()=>l[t],enumerable:!(s=c(l,t))||s.enumerable});return a})(t({"external-global-plugin:react"(t,e){e.exports=Spicetify.React}})()),b=e(d()),k=[],x=[],L=P=!(S={}),I=0,R=1,j="56px",C=O=E=g=w=h=null,T=async function(){for(;null==Spicetify||!Spicetify.showNotification;)await new Promise(t=>setTimeout(t,100));C=document.querySelector(".Root__main-view"),L=await JSON.parse(localStorage.getItem("spicetify-playlist-labels:show-all")||"false");const e=(t=null)=>{M(t).then(t=>{S=t,P=!0,H()})};await Spicetify.Platform.LibraryAPI.getEvents().addListener("update",t=>{e()}),await Spicetify.Platform.PlaylistAPI.getEvents().addListener("operation_complete",t=>{e(t.data.uri)});var t=`<svg data-encore-id="icon" role="img" viewBox="0 0 16 16" class="Svg-img-icon-small">${Spicetify.SVGIcons.spotify}</svg>`,t=(new Spicetify.Playbar.Button("Show All Saved Playlists",t,t=>{t.active=L=!t.active,localStorage.setItem("spicetify-playlist-labels:show-all",JSON.stringify(L)),P=!0,H()},!1,L),S=await M(),g=new MutationObserver(()=>{H()}),new MutationObserver(async()=>{await B()}));await B(),t.observe(document.body,{childList:!0,subtree:!0}),new ResizeObserver(t=>{D()}).observe(C)},(async()=>{await T()})();function N(t){let a=[],l=[];return function e(i,t){"playlist"===i.type?(t?l:a).push(i):"folder"===i.type&&i.items&&i.items.forEach(t=>e(t,"Rated"==i.name))}(t,!1),[a,l]}async function _(){const[t,i]=N(await Spicetify.Platform.RootlistAPI.getContents()),a=(await async function(){let t=[];var e;let i="https://api.spotify.com/v1/me/playlists";for(;i;)e=await Spicetify.CosmosAsync.get(i),t=t.concat(e.items),i=e.next;return t}()).reduce((t,e)=>(t[e.uri]=e.snapshot_id,t),{});let e=[...t,...i];return e=e.map(e=>f(m({},e),{snapshotId:a[e.uri],isRatedPlaylist:i.some(t=>t.uri===e.uri)}))}function A(a,t,e){t.forEach(i=>{e[i.uri].forEach(t=>{var e=t.uri;a[e]||(a[e]=[]),a[e].some(t=>t.uri===i.uri)||a[e].push({uri:i.uri,name:i.name,trackUid:t.uid,image:(null==(e=i.images[0])?void 0:e.url)||"",isOwnPlaylist:i.isOwnedBySelf,isLikedTracks:!1})})})}async function M(i){var t,e=await new Promise((e,i)=>{var t=indexedDB.open("spicetify-playlist-labels",1);t.onerror=t=>{i(t)},t.onupgradeneeded=t=>{t=t.target.result;t.createObjectStore("playlists",{keyPath:"uri"}),t.createObjectStore("playlistItems",{keyPath:"uri"})},t.onsuccess=t=>{e(t.target.result)}});t=e;const a=await new Promise((e,i)=>{const a=t.transaction("playlists").objectStore("playlists").getAll();a.onsuccess=t=>{e(a.result)},a.onerror=t=>{i(t)}});l=e;var l,r=await new Promise((e,i)=>{const a=l.transaction("playlistItems").objectStore("playlistItems").getAll();a.onsuccess=t=>{e(a.result)},a.onerror=t=>{i(t)}}),s=await _();const n=[],o=(s.forEach(e=>{var t=a.find(t=>t.uri===e.uri);t&&t.snapshotId===e.snapshotId&&e.uri!=i||n.push(e)}),[]);r.forEach(t=>{o[t.uri]=t.items});r=await Promise.all(n.map(t=>async function(t){return(await Spicetify.Platform.PlaylistAPI.getContents(t)).items}(t.uri)));const c={},p=(r.forEach((t,e)=>{e=n[e].uri;c[e]=t}),{});s.forEach(t=>{t=t.uri;c[t]?p[t]=c[t]:p[t]=o[t]}),p.likedTracks=o.likedTracks;var r=JSON.parse(localStorage.getItem("spicetify-playlist-labels:liked-tracks-count")||"0"),u=await(await Spicetify.Platform.LibraryAPI.getTracks()).totalLength;let y=p.likedTracks;y&&r==u||(y=(y=await Spicetify.Platform.LibraryAPI.getTracks({limit:Number.MAX_SAFE_INTEGER})).items,p.likedTracks=y);const m={};var f,d,v,b,h,w,r=s.filter(t=>t.isRatedPlaylist),g=s.filter(t=>!t.isRatedPlaylist);return A(m,r,p),y.forEach(t=>{var e=t.uri;m[e]||(m[e]=[]),m[e].some(t=>t.isLikedTracks)||m[e].push({uri:null,name:"Liked Songs",trackUid:t.uid,image:"https://misc.scdn.co/liked-songs/liked-songs-300.png",isOwnPlaylist:!0,isLikedTracks:!0})}),A(m,g,p),f=e,await new Promise((e,i)=>{var t=f.transaction("playlists","readwrite").objectStore("playlists").clear();t.onsuccess=t=>{e()},t.onerror=t=>{i(t)}}),d=e,await new Promise((e,i)=>{var t=d.transaction("playlistItems","readwrite").objectStore("playlistItems").clear();t.onsuccess=t=>{e()},t.onerror=t=>{i(t)}}),v=e,b=s,await new Promise((e,i)=>{const a=v.transaction("playlists","readwrite").objectStore("playlists");b.forEach(t=>{a.put(t)}),a.transaction.oncomplete=t=>{e()},a.transaction.onerror=t=>{i(t)}}),h=e,w=p,await new Promise((e,i)=>{const a=h.transaction("playlistItems","readwrite").objectStore("playlistItems");Object.entries(w).forEach(([t,e])=>{a.put({uri:t,items:e})}),a.transaction.oncomplete=t=>{e()},a.transaction.onerror=t=>{i(t)}}),localStorage.setItem("spicetify-playlist-labels:liked-tracks-count",u),m}function z(t){return t.match(/spotify:playlist:(.*)/)[1]}function D(){if(C){let e=R;var l="56px"==j?44:32,r=C.getBoundingClientRect();let i=0,a=516;i<=r.width&&r.width<=a&&(e=1);for(let t=1;t<19;t++)i=517+l*(t-1),a=517+l*t,i<=r.width&&r.width<=a&&(e=t+1);i=517+18*l,(e=i<=r.width?20:e)!==R&&(R=e,document.documentElement.style.setProperty("--spicetify-playlist-labels-max-label-count",""+R),P=!0,H())}}function H(){var t;x=k,k=Array.from(document.querySelectorAll(".main-trackList-indexable")),x.length===k.length&&x.every((t,e)=>t===k[e])||(I=0);for(const e of k){for(const l of e.getElementsByClassName("main-trackList-trackListRow")){var a=getComputedStyle(l).getPropertyValue("--row-height");a!=j&&(j=a,document.documentElement.style.setProperty("--spicetify-playlist-labels-size",`calc(${j} * 0.5)`),D(),P=!0);a=l,t=void 0;const r=(a=Object.values(a))?(null==(t=null==(a=null==(a=null==(a=null==(a=null==(a=a[0])?void 0:a.pendingProps)?void 0:a.children[0])?void 0:a.props)?void 0:a.children)?void 0:a.props)?void 0:t.uri)||(null==(t=null==(t=null==(t=null==a?void 0:a.props)?void 0:t.children)?void 0:t.props)?void 0:t.uri)||(null==(t=null==(t=null==(t=null==(t=null==(t=null==a?void 0:a.props)?void 0:t.children)?void 0:t.props)?void 0:t.children)?void 0:t.props)?void 0:t.uri)||(null==(a=null==(t=a[0])?void 0:t.props)?void 0:a.uri):null;E===r&&Spicetify.Platform.History.location.pathname===O&&(l.click(),E=null);let e=(null!=(t=S[r])?t:[]).filter(t=>{if(!L&&!t.isOwnPlaylist)return!1;if(t.isLikedTracks){if("/collection/tracks"===Spicetify.Platform.History.location.pathname)return!1}else{t=z(t.uri);if(Spicetify.Platform.History.location.pathname==="/playlist/"+t)return!1}return!0}),i=(e.length>I&&(I=e.length,document.documentElement.style.setProperty("--spicetify-playlist-labels-label-count",""+I)),l.querySelector(".spicetify-playlist-labels"));if(P&&i&&(i.remove(),i=null),!i){a=l.querySelector(".main-trackList-rowSectionEnd");(i=document.createElement("div")).classList.add("spicetify-playlist-labels");let t="spicetify-playlist-labels-labels-container";e.length>R&&(t+=" spicetify-playlist-labels-overflow"),e=e.slice(0,R),b.default.render(v.default.createElement("div",{className:t},e.map(e=>{if(!L&&!e.isOwnPlaylist)return null;if(e.isLikedTracks){if("/collection/tracks"===Spicetify.Platform.History.location.pathname)return null}else{var t=z(e.uri);if(Spicetify.Platform.History.location.pathname==="/playlist/"+t)return null}return v.default.createElement(Spicetify.ReactComponent.TooltipWrapper,{label:e.name,placement:"top"},v.default.createElement("div",null,v.default.createElement(Spicetify.ReactComponent.RightClickMenu,{placement:"bottom-end",menu:e.isLikedTracks?null:v.default.createElement(Spicetify.ReactComponent.Menu,null,v.default.createElement(Spicetify.ReactComponent.MenuItem,{leadingIcon:v.default.createElement(Spicetify.ReactComponent.IconComponent,{dangerouslySetInnerHTML:{__html:'<path d="M5.25 3v-.917C5.25.933 6.183 0 7.333 0h1.334c1.15 0 2.083.933 2.083 2.083V3h4.75v1.5h-.972l-1.257 9.544A2.25 2.25 0 0 1 11.041 16H4.96a2.25 2.25 0 0 1-2.23-1.956L1.472 4.5H.5V3h4.75zm1.5-.917V3h2.5v-.917a.583.583 0 0 0-.583-.583H7.333a.583.583 0 0 0-.583.583zM2.986 4.5l1.23 9.348a.75.75 0 0 0 .744.652h6.08a.75.75 0 0 0 .744-.652L13.015 4.5H2.985z"></path>'},iconSize:16,style:{color:"var(--text-subdued)"}}),onClick:t=>{t.stopPropagation(),async function(t,e){await Spicetify.Platform.PlaylistAPI.remove(t,[{uri:e,uid:""}])}(e.uri,r),S[r]=S[r].filter(t=>t.uri!==e.uri),P=!0,H()}},"Remove from ",e.name))},v.default.createElement("div",{className:"spicetify-playlist-labels-label-container",style:{cursor:"pointer"},onClick:t=>{t.stopPropagation();t=e.isLikedTracks?"/collection/tracks":null==(t=Spicetify.URI.fromString(e.uri))?void 0:t.toURLPath(!0);E=r,(O=t)&&Spicetify.Platform.History.push({pathname:t,search:"?uid="+e.trackUid})}},v.default.createElement("img",{src:e.image})))))})),i),a.insertBefore(i,a.firstChild)}}P=!1}}async function B(){h=w,(w=document.querySelector("main"))&&!w.isEqualNode(h)&&(h&&g.disconnect(),H(),g.observe(w,{childList:!0,subtree:!0}))}(async()=>{var t;document.getElementById("spicetifyDplaylistDlabels")||((t=document.createElement("style")).id="spicetifyDplaylistDlabels",t.textContent=String.raw`
  :root{--spicetify-playlist-labels-size:28px;--spicetify-playlist-labels-gap:6px;--spicetify-playlist-labels-container-max-width:calc((var(--spicetify-playlist-labels-size) + var(--spicetify-playlist-labels-gap)) * var(--spicetify-playlist-labels-max-label-count, 1) + 16px);--spicetify-playlist-labels-container-width:min(var(--spicetify-playlist-labels-container-max-width), calc(var(--spicetify-playlist-labels-size) * var(--spicetify-playlist-labels-label-count, 1) + var(--spicetify-playlist-labels-gap) * calc(var(--spicetify-playlist-labels-label-count, 1) - 1)))}.spicetify-playlist-labels-labels-container{width:var(--spicetify-playlist-labels-container-width);height:var(--row-height);align-items:center;display:flex;flex-direction:row-reverse;overflow:hidden;gap:var(--spicetify-playlist-labels-gap);justify-content:flex-start;max-width:var(--spicetify-playlist-labels-container-max-width)}.spicetify-playlist-labels-labels-container:after{content:"\22ef";display:none;color:var(--text-base)}.spicetify-playlist-labels-labels-container.spicetify-playlist-labels-overflow:after{display:block}.spicetify-playlist-labels-label-container{position:relative;height:calc(var(--row-height) * .5)}.spicetify-playlist-labels-label-container>img{width:calc(var(--row-height) * .5);height:100%;-o-object-fit:cover;object-fit:cover;border-radius:calc(var(--row-height) * .5 * .1)}.main-trackList-trackList.main-trackList-indexable[aria-colcount="4"] .main-trackList-trackListRowGrid{grid-template-columns:[index] var(--tracklist-index-column-width,16px) [first] minmax(120px,var(--col1,4fr)) [var1] minmax(120px,var(--col2,2fr)) [last] calc(120px + var(--spicetify-playlist-labels-container-width) + 12px)!important}.main-trackList-trackList.main-trackList-indexable[aria-colcount="5"] .main-trackList-trackListRowGrid{grid-template-columns:[index] var(--tracklist-index-column-width,16px) [first] minmax(120px,var(--col1,6fr)) [var1] minmax(120px,var(--col2,4fr)) [var2] minmax(120px,var(--col3,3fr)) [last] calc(120px + var(--spicetify-playlist-labels-container-width) + 12px)!important}.main-trackList-trackList.main-trackList-indexable[aria-colcount="6"] .main-trackList-trackListRowGrid{grid-template-columns:[index] var(--tracklist-index-column-width,16px) [first] minmax(120px,var(--col1,6fr)) [var1] minmax(120px,var(--col2,4fr)) [var2] minmax(120px,var(--col3,3fr)) [var3] minmax(120px,var(--col4,2fr)) [last] calc(120px + var(--spicetify-playlist-labels-container-width) + 12px)!important}
      `.trim(),document.head.appendChild(t))})()}();