!async function(){for(;!Spicetify.React||!Spicetify.ReactDOM;)await new Promise(t=>setTimeout(t,10));var n,o,i,c,a,p,l,u,m,r,s,d,y,t,e,f,v,b,h,w,g,k,S,x,P,L,E,O,I,j;n=Object.create,o=Object.defineProperty,i=Object.defineProperties,c=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertyNames,l=Object.getOwnPropertySymbols,u=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,s=(t,e,i)=>e in t?o(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,d=(t,e)=>{for(var i in e=e||{})m.call(e,i)&&s(t,i,e[i]);if(l)for(var i of l(e))r.call(e,i)&&s(t,i,e[i]);return t},y=(t,e)=>i(t,a(e)),f=(t=(t,e)=>function(){return e||(0,t[p(t)[0]])((e={exports:{}}).exports,e),e.exports})({"external-global-plugin:react-dom"(t,e){e.exports=Spicetify.ReactDOM}}),v=(e=(t,e,i)=>{i=null!=t?n(u(t)):{};var a=!e&&t&&t.__esModule?i:o(i,"default",{value:t,enumerable:!0}),l=t,r=void 0,s=void 0;if(l&&"object"==typeof l||"function"==typeof l)for(let t of p(l))m.call(a,t)||t===r||o(a,t,{get:()=>l[t],enumerable:!(s=c(l,t))||s.enumerable});return a})(t({"external-global-plugin:react"(t,e){e.exports=Spicetify.React}})()),b=e(f()),k=[],S=[],L=P=!(x={}),O=E=g=w=h=null,I=0,j=async function(){for(;null==Spicetify||!Spicetify.showNotification;)await new Promise(t=>setTimeout(t,100));L=await JSON.parse(localStorage.getItem("spicetify-playlist-labels:show-all")||"false");const t=()=>{A().then(t=>{x=t,P=!0,M()})};await Spicetify.Platform.RootlistAPI.getEvents().addListener("update",()=>{t()}),await Spicetify.Platform.LibraryAPI.getEvents().addListener("update",()=>{t()});var e=`<svg data-encore-id="icon" role="img" viewBox="0 0 16 16" class="Svg-img-icon-small">${Spicetify.SVGIcons.spotify}</svg>`,e=(new Spicetify.Playbar.Button("Show All Saved Playlists",e,t=>{t.active=L=!t.active,localStorage.setItem("spicetify-playlist-labels:show-all",JSON.stringify(L)),P=!0,M()},!1,L),x=await A(),g=new MutationObserver(()=>{M()}),new MutationObserver(async()=>{await N()}));await N(),e.observe(document.body,{childList:!0,subtree:!0})},(async()=>{await j()})();function R(t){let a=[],l=[];return function e(i,t){"playlist"===i.type?(t?l:a).push(i):"folder"===i.type&&i.items&&i.items.forEach(t=>e(t,"Rated"==i.name))}(t,!1),[a,l]}async function C(){const[t,i]=R(await Spicetify.Platform.RootlistAPI.getContents()),a=(await async function(){let t=[];var e;let i="https://api.spotify.com/v1/me/playlists";for(;i;)e=await Spicetify.CosmosAsync.get(i),t=t.concat(e.items),i=e.next;return t}()).reduce((t,e)=>(t[e.uri]=e.snapshot_id,t),{});let e=[...t,...i];return e=e.map(e=>y(d({},e),{snapshotId:a[e.uri],isRatedPlaylist:i.some(t=>t.uri===e.uri)}))}function T(a,t,e){t.forEach(i=>{e[i.uri].forEach(t=>{var e=t.uri;a[e]||(a[e]=[]),a[e].some(t=>t.uri===i.uri)||a[e].push({uri:i.uri,name:i.name,trackUid:t.uid,image:(null==(e=i.images[0])?void 0:e.url)||"",isOwnPlaylist:i.isOwnedBySelf,isLikedTracks:!1})})})}async function A(){var t,e=await new Promise((e,i)=>{var t=indexedDB.open("spicetify-playlist-labels",1);t.onerror=t=>{i(t)},t.onupgradeneeded=t=>{t=t.target.result;t.createObjectStore("playlists",{keyPath:"uri"}),t.createObjectStore("playlistItems",{keyPath:"uri"})},t.onsuccess=t=>{e(t.target.result)}});t=e;const i=await new Promise((e,i)=>{const a=t.transaction("playlists").objectStore("playlists").getAll();a.onsuccess=t=>{e(a.result)},a.onerror=t=>{i(t)}});l=e;var l,a=await new Promise((e,i)=>{const a=l.transaction("playlistItems").objectStore("playlistItems").getAll();a.onsuccess=t=>{e(a.result)},a.onerror=t=>{i(t)}}),r=await C();const s=[],n=(r.forEach(e=>{var t=i.find(t=>t.uri===e.uri);t&&t.snapshotId===e.snapshotId||s.push(e)}),[]);a.forEach(t=>{n[t.uri]=t.items});a=await Promise.all(s.map(t=>async function(t){return(await Spicetify.Platform.PlaylistAPI.getContents(t)).items}(t.uri)));const o={},c=(a.forEach((t,e)=>{e=s[e].uri;o[e]=t}),{});r.forEach(t=>{t=t.uri;o[t]?c[t]=o[t]:c[t]=n[t]}),c.likedTracks=n.likedTracks;var a=JSON.parse(localStorage.getItem("spicetify-playlist-labels:liked-tracks-count")||"0"),p=await(await Spicetify.Platform.LibraryAPI.getTracks()).totalLength;let u=c.likedTracks;u&&a==p||(u=(u=await Spicetify.Platform.LibraryAPI.getTracks({limit:Number.MAX_SAFE_INTEGER})).items,c.likedTracks=u);const m={};var d,y,f,v,b,h,a=r.filter(t=>t.isRatedPlaylist),w=r.filter(t=>!t.isRatedPlaylist);return T(m,w,c),u.forEach(t=>{var e=t.uri;m[e]||(m[e]=[]),m[e].some(t=>t.isLikedTracks)||m[e].push({uri:null,name:"Liked Songs",trackUid:t.uid,image:"https://misc.scdn.co/liked-songs/liked-songs-300.png",isOwnPlaylist:!0,isLikedTracks:!0})}),T(m,a,c),d=e,await new Promise((e,i)=>{var t=d.transaction("playlists","readwrite").objectStore("playlists").clear();t.onsuccess=t=>{e()},t.onerror=t=>{i(t)}}),y=e,await new Promise((e,i)=>{var t=y.transaction("playlistItems","readwrite").objectStore("playlistItems").clear();t.onsuccess=t=>{e()},t.onerror=t=>{i(t)}}),f=e,v=r,await new Promise((e,i)=>{const a=f.transaction("playlists","readwrite").objectStore("playlists");v.forEach(t=>{a.put(t)}),a.transaction.oncomplete=t=>{e()},a.transaction.onerror=t=>{i(t)}}),b=e,h=c,await new Promise((e,i)=>{const a=b.transaction("playlistItems","readwrite").objectStore("playlistItems");Object.entries(h).forEach(([t,e])=>{a.put({uri:t,items:e})}),a.transaction.oncomplete=t=>{e()},a.transaction.onerror=t=>{i(t)}}),localStorage.setItem("spicetify-playlist-labels:liked-tracks-count",p),m}function M(){var e,i;S=k,k=Array.from(document.querySelectorAll(".main-trackList-indexable")),S.length===k.length&&S.every((t,e)=>t===k[e])||(I=0);for(const t of k){for(const a of t.getElementsByClassName("main-trackList-trackListRow")){e=a,i=void 0;const l=(e=Object.values(e))?(null==(i=null==(e=null==(e=null==(e=null==(e=null==(e=e[0])?void 0:e.pendingProps)?void 0:e.children[0])?void 0:e.props)?void 0:e.children)?void 0:e.props)?void 0:i.uri)||(null==(i=null==(i=null==(i=null==e?void 0:e.props)?void 0:i.children)?void 0:i.props)?void 0:i.uri)||(null==(i=null==(i=null==(i=null==(i=null==(i=null==e?void 0:e.props)?void 0:i.children)?void 0:i.props)?void 0:i.children)?void 0:i.props)?void 0:i.uri)||(null==(e=null==(i=e[0])?void 0:i.props)?void 0:e.uri):null;E===l&&Spicetify.Platform.History.location.pathname===O&&(a.click(),E=null),(null==(i=x[l])?void 0:i.length)>I&&(I=null==(e=x[l])?void 0:e.length,document.documentElement.style.setProperty("--spicetify-playlist-labels-label-count",""+I));let t=a.querySelector(".spicetify-playlist-labels");P&&t&&(t.remove(),t=null),t||(i=a.querySelector(".main-trackList-rowSectionEnd"),(t=document.createElement("div")).classList.add("spicetify-playlist-labels"),b.default.render(v.default.createElement("div",{className:"spicetify-playlist-labels-labels-container"},null==(e=x[l])?void 0:e.map(e=>{if(!L&&!e.isOwnPlaylist)return null;if(e.isLikedTracks){if("/collection/tracks"===Spicetify.Platform.History.location.pathname)return null}else{var t=e.uri.match(/spotify:playlist:(.*)/)[1];if(Spicetify.Platform.History.location.pathname==="/playlist/"+t)return null}return v.default.createElement(Spicetify.ReactComponent.TooltipWrapper,{label:e.name,placement:"top"},v.default.createElement("div",null,v.default.createElement(Spicetify.ReactComponent.RightClickMenu,{placement:"bottom-end",menu:e.isLikedTracks?null:v.default.createElement(Spicetify.ReactComponent.Menu,null,v.default.createElement(Spicetify.ReactComponent.MenuItem,{leadingIcon:v.default.createElement(Spicetify.ReactComponent.IconComponent,{dangerouslySetInnerHTML:{__html:'<path d="M5.25 3v-.917C5.25.933 6.183 0 7.333 0h1.334c1.15 0 2.083.933 2.083 2.083V3h4.75v1.5h-.972l-1.257 9.544A2.25 2.25 0 0 1 11.041 16H4.96a2.25 2.25 0 0 1-2.23-1.956L1.472 4.5H.5V3h4.75zm1.5-.917V3h2.5v-.917a.583.583 0 0 0-.583-.583H7.333a.583.583 0 0 0-.583.583zM2.986 4.5l1.23 9.348a.75.75 0 0 0 .744.652h6.08a.75.75 0 0 0 .744-.652L13.015 4.5H2.985z"></path>'},iconSize:16,style:{color:"var(--text-subdued)"}}),onClick:t=>{t.stopPropagation(),async function(t,e){await Spicetify.Platform.PlaylistAPI.remove(t,[{uri:e,uid:""}])}(e.uri,l),x[l]=x[l].filter(t=>t.uri!==e.uri),P=!0,M()}},"Remove from ",e.name))},v.default.createElement("div",{className:"spicetify-playlist-labels-label-container",style:{cursor:"pointer"},onClick:t=>{t.stopPropagation();t=e.isLikedTracks?"/collection/tracks":null==(t=Spicetify.URI.fromString(e.uri))?void 0:t.toURLPath(!0);E=l,(O=t)&&Spicetify.Platform.History.push({pathname:t,search:"?uid="+e.trackUid})}},v.default.createElement("img",{src:e.image})))))})),t),i.insertBefore(t,i.firstChild))}P=!1}}async function N(){h=w,(w=document.querySelector("main"))&&!w.isEqualNode(h)&&(h&&g.disconnect(),M(),g.observe(w,{childList:!0,subtree:!0}))}(async()=>{var t;document.getElementById("spicetifyDplaylistDlabels")||((t=document.createElement("style")).id="spicetifyDplaylistDlabels",t.textContent=String.raw`
  :root{--spicetify-playlist-labels-size:28px;--spicetify-playlist-labels-gap:6px;--spicetify-playlist-labels-container-width:calc(var(--spicetify-playlist-labels-size) * var(--spicetify-playlist-labels-label-count, 3) + var(--spicetify-playlist-labels-gap) * calc(var(--spicetify-playlist-labels-label-count, 3) - 1))}.spicetify-playlist-labels-labels-container{width:var(--spicetify-playlist-labels-container-width);height:var(--row-height);align-items:center;display:flex;overflow:hidden;gap:var(--spicetify-playlist-labels-gap);justify-content:flex-end}.spicetify-playlist-labels-label-container{position:relative;height:calc(var(--row-height) * .5)}.spicetify-playlist-labels-label-container>img{width:calc(var(--row-height) * .5);height:100%;-o-object-fit:cover;object-fit:cover;border-radius:calc(var(--row-height) * .5 * .1)}.main-trackList-trackList.main-trackList-indexable[aria-colcount="4"] .main-trackList-trackListRowGrid{grid-template-columns:[index] var(--tracklist-index-column-width,16px) [first] minmax(120px,var(--col1,4fr)) [var1] minmax(120px,var(--col2,2fr)) [last] calc(120px + var(--spicetify-playlist-labels-container-width) + 12px)!important}.main-trackList-trackList.main-trackList-indexable[aria-colcount="5"] .main-trackList-trackListRowGrid{grid-template-columns:[index] var(--tracklist-index-column-width,16px) [first] minmax(120px,var(--col1,6fr)) [var1] minmax(120px,var(--col2,4fr)) [var2] minmax(120px,var(--col3,3fr)) [last] calc(120px + var(--spicetify-playlist-labels-container-width) + 12px)!important}.main-trackList-trackList.main-trackList-indexable[aria-colcount="6"] .main-trackList-trackListRowGrid{grid-template-columns:[index] var(--tracklist-index-column-width,16px) [first] minmax(120px,var(--col1,6fr)) [var1] minmax(120px,var(--col2,4fr)) [var2] minmax(120px,var(--col3,3fr)) [var3] minmax(120px,var(--col4,2fr)) [last] calc(120px + var(--spicetify-playlist-labels-container-width) + 12px)!important}
      `.trim(),document.head.appendChild(t))})()}();